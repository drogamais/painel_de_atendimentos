table bridgeChamadoSultsApoio
	lineageTag: f94c5c60-c0ee-4386-83ca-911099cf29e0

	column id_apoio
		dataType: string
		lineageTag: 4820550a-407f-4656-bd74-2a5447d2a562
		summarizeBy: none
		sourceColumn: id_apoio

		annotation SummarizationSetBy = Automatic

	column id_chamado
		dataType: int64
		formatString: 0
		lineageTag: 8ea3d1af-2142-4c10-a0e6-f77f9cf50849
		summarizeBy: none
		sourceColumn: id_chamado

		annotation SummarizationSetBy = Automatic

	column nome_apoio
		dataType: string
		lineageTag: 8b4b7b8f-62ff-4197-bd5f-1196066217dd
		summarizeBy: none
		sourceColumn: nome_apoio

		annotation SummarizationSetBy = Automatic

	column id_pessoa_apoio
		dataType: int64
		formatString: 0
		lineageTag: a7d05974-9595-495b-95e6-9473cf759397
		summarizeBy: none
		sourceColumn: id_pessoa_apoio

		annotation SummarizationSetBy = Automatic

	column 'Nome Apoio' =
			
			IF(
			    -- IDs sults do marketing
			    bridgeChamadoSultsApoio[id_pessoa_apoio] IN {58, 67, 70},
			
			    -- Se o ID está na lista, busca o nome pela relação ATIVA
			    RELATED(dimPessoa[nome_oficial]),
			
			    -- Caso contrário, retorna "Outro"
			    "Outro"
			)
		lineageTag: 08f61875-d45e-416d-a8a0-dc9d3c1ffb01
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	partition bridgeChamadoSultsApoio = m
		mode: import
		source =
				let
				    Fonte = Odbc.DataSource("dsn=dbSults", [HierarchicalNavigation=true]),
				    dbSults_Database = Fonte{[Name="dbSults",Kind="Database"]}[Data],
				    vw_prata_chamados_sults_apoio_View = dbSults_Database{[Name="vw_prata_chamados_sults_apoio",Kind="View"]}[Data]
				in
				    vw_prata_chamados_sults_apoio_View

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

